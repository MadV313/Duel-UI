<<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DayZ CCG Duel Field</title>
  <link rel="stylesheet" href="styles/style.css">

  <!-- Duel Loader (for Discord-initiated PvP matches) -->
  <script type="module" src="scripts/duelLoader.js" defer></script>

  <!-- Script Modules -->
  <script type="module" src="scripts/duelState.js" defer></script>
  <script type="module" src="scripts/renderCard.js" defer></script>
  <script type="module" src="scripts/renderHand.js" defer></script>
  <script type="module" src="scripts/renderField.js" defer></script>
  <script type="module" src="scripts/renderDuelUI.js" defer></script>
  <script type="module" src="scripts/animations.js" defer></script>
  <script type="module" src="scripts/coinFlip.js" defer></script>
  <script type="module" src="scripts/duel.js" defer></script>
  <script type="module" src="scripts/buffTracker.js" defer></script>

  <!-- Spectator View Script (for non-player observers) -->
  <script type="module" src="scripts/spectatorView.js" defer></script>

  <!-- Add Spectator Styles (for non-interactive view) -->
  <link rel="stylesheet" href="styles/spectatorStyles.css" id="spectatorStyles">
</head>

<body>
  <div id="background"></div>

  <!-- Player 2 (Opponent) Top -->
  <div id="player2-hand" class="hand"></div>
  <div id="player2-field" class="field"></div>

  <!-- HP & Turn Display -->
  <div id="hp-display">
    <div>Challenger HP: <span id="player1-hp">200</span></div>
    <div>Opponent HP: <span id="player2-hp">200</span></div>
  </div>
  <div id="turn-display"></div>

  <!-- Player 1 (Challenger) Bottom -->
  <div id="player1-field" class="field"></div>
  <div id="player1-hand" class="hand"></div>

  <!-- Duel Controls -->
  <div id="controls">

    <!-- ðŸ”˜ Practice Duel Button (conditionally shown) -->
    <div style="margin-bottom: 12px;">
      <button id="startPracticeBtn" onclick="loadPracticeDuel()" style="display: none;">ðŸŽ® Start Practice Duel</button>
    </div>

    <!-- Controls (only visible for players) -->
    <button onclick="drawCard()">Draw</button>
    <button onclick="endTurn()">End Turn</button>
    <button onclick="flipCoin()">Flip Coin</button>
    <button onclick="loadPracticeDuel()">Load Practice Duel</button>
  </div>

  <!-- Overlay display area for coin flip result -->
  <div id="announcement" class="overlay hidden"></div>

  <!-- Coin Flip Animation Container -->
  <div id="coinFlipContainer" style="display:none; position: fixed; top: 40%; left: 50%; transform: translate(-50%, -50%); z-index: 9999;">
    <img src="images/coinflip.gif" alt="Coin Flip" style="width: 120px; height: 120px;" />
  </div>

  <!-- Inject Practice Duel Loader -->
  <script type="module">
    import { loadPracticeDuel } from './scripts/loadPracticeDuel.js';
    window.loadPracticeDuel = loadPracticeDuel;
  </script>

  <!-- Inject Coin Flip Logic -->
  <script type="module">
    import { flipCoin } from './scripts/coinFlip.js';
    window.flipCoin = flipCoin;
  </script>

  <!-- Practice Mode Button Visibility -->
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('practice') === 'true') {
      document.getElementById("startPracticeBtn").style.display = "inline-block";
    }
  </script>

  <!-- Spectator Detection & Conditional Rendering -->
  <script>
    const isSpectator = window.location.search.includes('spectator=true');
    if (isSpectator) {
      renderSpectatorView();
      document.getElementById('controls').style.display = 'none';
      document.getElementById('spectatorStyles').disabled = false;
    } else {
      renderDuelUI();
      document.getElementById('spectatorStyles').disabled = true;
    }
  </script>
</body>
</html>
